class Powcaptcha{static tmpHelpers={};static createChallenge(e=50){if(Powcaptcha.init(),!Powcaptcha.tmpHelpers.randomBytes)throw new Error("This device cannot create a challenge as randomBytes function (Crypto module) is missing");var a=[];for(let t=0;t<e;t++)a.push(Powcaptcha.byteArrayToHex(Powcaptcha.tmpHelpers.randomBytes(16)));return a.join("")}static verifySolution(e,a,t=4){if(!e||e.length<32||e.length%32)throw new Error("Invalid challenge string");var r=e.length/32,n=t+2;if(!a||a.length!==r*n)throw new Error("Invalid solution");Powcaptcha.init();var o=Math.pow(10,10-t);for(let t=0;t<r;t++){var i=a.substring(t*n,t*n+n),c=e.substring(32*t,32*t+32);if(!(Powcaptcha.hashInt(c+i)<=o))return!1}return!0}static async solveChallenge(n,o=4,i=null){if(Powcaptcha.init(),o<1||7<o)throw new Error("Difficulty need to be between 1-7");if(!n||n.length<32||n.length%32)throw new Error("Invalid challenge string");if("undefined"==typeof window||"function"!=typeof Worker)return Powcaptcha.solverWorker(n,o,i);{var c=Powcaptcha.toString()+";\n",s=(c+="Powcaptcha.init();",[]);let a=n.length/32,r=0;for(let e=0;e<n.length;e+=32){var l=c,p=n.substring(e,e+32),p=(l+="(async()=>{self.postMessage(Powcaptcha.solverWorker("+JSON.stringify(p)+", "+JSON.stringify(o)+"))})()",new Blob([l],{type:"text/javascript"}));let t=new Worker(URL.createObjectURL(p));s.push(new Promise(e=>{t.onmessage=t=>{"string"==typeof t.data&&(r++,i&&i(1/a*r),e(t.data))}}))}return(await Promise.all(s)).join("")}}static hash(e){Powcaptcha.init(),e="string"==typeof e?Powcaptcha.tmpHelpers.encode(e):e;let a=2166136261,r=2341284503,n=3386659096,o=2073922445;var i=16777619;for(let t=0;t<e.byteLength;t++){var c=e[t];a=(a^c)>>>0,a=Math.imul(a,i)>>>0,r=(r^c<<1&255)>>>0,r=Math.imul(r,i)>>>0,n=(n^c<<2&255)>>>0,n=Math.imul(n,i)>>>0,o=(o^c<<3&255)>>>0,o=Math.imul(o,i)>>>0}return this.fmix(a)+this.fmix(r)+this.fmix(n)+this.fmix(o)}static hashInt(e){Powcaptcha.init(),e="string"==typeof e?Powcaptcha.tmpHelpers.encode(e):e;let a=2166136261;for(let t=0;t<e.byteLength;t++){var r=e[t];a=(a^r)>>>0,a=Math.imul(a,16777619)>>>0}return this.fmix(a,!1)}static solverWorker(a,r=4,n=null){var o=a.length/32,i=Math.pow(10,10-r),c=Math.pow(10,r+2);let s="";for(let e=0;e<o;e++){let t=Math.pow(10,r+1);for(var l=a.substring(32*e,32*e+32);t<=c;){if(Powcaptcha.hashInt(l+t)<=i){"function"==typeof n&&n(1/o*(e+1)),s+=t;break}t++}}return s}static fmix(t,e=!0){var a=65535&(t=((t>>>=0)^t>>>16)>>>0),a=(t=51819*a+(51819*(t>>>16&65535)+34283*a<<16>>>0)>>>0&4294967295,65535&(t^=t>>>13));return t=((t=44597*a+(44597*(t>>>16&65535)+49842*a<<16>>>0)>>>0&4294967295)^t>>>16)>>>0,e?t.toString(16).padStart(8,"0"):t>>>0}static init(){if(void 0===Powcaptcha.tmpHelpers.encode){let e=new TextEncoder;if(Powcaptcha.tmpHelpers.encode=t=>e.encode(t),"undefined"!=typeof window||"undefined"!=typeof self){let e=(self||window).crypto;void 0!==e&&(Powcaptcha.tmpHelpers.randomBytes=t=>e.getRandomValues(new Uint8Array(t)))}}}static byteArrayToHex(e){if(void 0===Powcaptcha.tmpHelpers.hexMap){Powcaptcha.tmpHelpers.hexMap=[];for(let t=0;t<=255;t++)Powcaptcha.tmpHelpers.hexMap.push(t.toString(16).padStart(2,"0"))}e instanceof Uint8Array||(e=new Uint8Array(e));let a="";for(let t=0;t<e.byteLength;t++)a+=Powcaptcha.tmpHelpers.hexMap[e[t]];return a}}"undefined"!=typeof module&&module.exports&&(module.exports=Powcaptcha);